type MeasureDetail = {
  id: string;
  title: string;
  description: string;
  triggers: string[];
};

export const MEASURE_DETAILS: MeasureDetail[] = [
  {
    id: 'Мера ТТП №1',
    title: 'Повышение ставки до уровня обязательства ВТО',
    description:
      'Рекомендуется довести ставку таможенной пошлины до максимально допустимого уровня в соответствии с обязательствами России в ВТО.',
    triggers: [
      'Текущая ставка ЕТТ ЕАЭС ниже предельной по обязательствам России в ВТО',
      'Доля импорта из недружественных стран менее 30% и снижается',
      'Российское производство закрывает внутреннее потребление'
    ]
  },
  {
    id: 'Мера ТТП №2',
    title: 'Повышение ставки до 35–50%',
    description:
      'Рассмотреть возможность повышения ставки в рамках национального контрсанкционного регулирования до диапазона 35–50%.',
    triggers: [
      'Доля импорта из недружественных стран превышает 30% и стабильна или растёт',
      'Российское производство удовлетворяет внутренний спрос'
    ]
  },
  {
    id: 'Мера ТТП №3',
    title: 'Антидемпинговое расследование',
    description:
      'Инициировать расследование в отношении экспортёров, поставляющих товар по демпинговым ценам (например, из Китая).',
    triggers: [
      'Доля импорта из Китая растёт в сравнении с предыдущими периодами',
      'Средняя контрактная цена китайских поставок ниже, чем у других стран',
      'Российское производство сокращается на горизонте последних четырёх лет'
    ]
  },
  {
    id: 'Мера ТТП №4',
    title: 'Преференции в госзакупках',
    description:
      'Расширить или инициировать применение преференциального режима в государственных закупках для отечественного товара.',
    triggers: [
      'Товар входит в перечни постановления Правительства РФ №1875',
      'Российское производство покрывает внутреннее потребление'
    ]
  },
  {
    id: 'Мера ТТП №5',
    title: 'Обязательная сертификация',
    description:
      'Установить обязательную сертификацию соответствия для импортируемого товара в рамках техрегламентов ЕАЭС.',
    triggers: [
      'Техрегламенты ЕАЭС или постановление №2425 требуют обязательной сертификации',
      'Товар отсутствует в перечне приказа Минпромторга №4114',
      'Импорт растёт, а российское производство снижается и не покрывает спрос'
    ]
  },
  {
    id: 'Мера ТТП №6',
    title: 'Иные меры защиты рынка',
    description:
      'Применить оставшиеся защитные меры: квоты, промышленный сбор, лицензирование или ограничения на импорт.',
    triggers: [
      'Совокупный импорт превышает рассчитанное потребление',
      'Производство в России сокращено или прекращается',
      'Не выполняются критерии для менее жёстких мер поддержки'
    ]
  }
];

export function findMeasureDetail(recommendation: string) {
  const normalized = recommendation.toLowerCase();
  const directMatch = MEASURE_DETAILS.find((item) => normalized.includes(item.id.toLowerCase()));
  if (directMatch) {
    return directMatch;
  }

  const numberMatch = normalized.match(/[№#]?\s*(\d)/u);
  if (numberMatch) {
    const index = Number(numberMatch[1]);
    if (index >= 1 && index <= MEASURE_DETAILS.length) {
      return MEASURE_DETAILS[index - 1];
    }
  }

  return undefined;
}
